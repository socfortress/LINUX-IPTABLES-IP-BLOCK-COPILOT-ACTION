{
  "copilot_action_name": "LINUX-IPTABLES-IP-BLOCK-COPILOT-ACTION",
  "description": "Blocks a specified IPv4 address using iptables by appending an INPUT rule to drop packets from the target IP. Validates IP format, checks if the IP is already blocked, and logs the outcome with detailed status and reason fields. Produces structured NDJSON output for auditing and writes atomically to the Active Response log with .new fallback if locked.",
  "technology": "Linux",
  "icon": "linux",
  "script_parameters": [
    {
      "name": "IP",
      "type": "string",
      "required": true,
      "description": "IPv4 address to block using iptables (e.g., 203.0.113.45).",
      "default": null
    },
    {
      "name": "ARLog",
      "type": "string",
      "required": false,
      "description": "Active Response NDJSON output path (atomic overwrite; falls back to .new if locked).",
      "default": "/var/ossec/active-response/active-responses.log"
    },
    {
      "name": "LogPath",
      "type": "string",
      "required": false,
      "description": "Path to the rotating human-readable script log.",
      "default": "/tmp/Block-IP-iptables.log"
    },
    {
      "name": "LogMaxKB",
      "type": "integer",
      "required": false,
      "description": "Maximum size of the log file (KB) before rotation.",
      "default": 100
    },
    {
      "name": "LogKeep",
      "type": "integer",
      "required": false,
      "description": "Number of rotated log files to keep.",
      "default": 5
    }
  ],
  "repo_url": "https://raw.githubusercontent.com/socfortress/LINUX-IPTABLES-IP-BLOCK-COPILOT-ACTION/refs/heads/main/",
  "script_name": "IPTABLES-IP-Block.sh",
  "version": "1.0.0",
  "last_updated": "2025-08-23T00:00:00Z"
}
